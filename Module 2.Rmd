---
title: "Module 2 Report - DATA2002 Student Survey"
author: '470336432, 470402449, SAYANOID'
date: "Semester 2 2019"
output: html_document
---

#                             Data Import

```{r, echo=FALSE, message=FALSE}
library(plyr)
library(dplyr)
library(tidyverse)
```

```{r, message=FALSE}
options(scipen=999) # stops the scientific notation
options(warn=-1) # stops the annoying warnings
x = readr::read_csv("data.csv", na = c("NA",""," ", "n/a"))
```

# Data Exploration

The dataset used comes from a class survey of the students in DATA2002. There were 110 respondents who each answered 22 questions about themselves. A timestamp variable of when respondents completed the survey is also included.


####  Data Limitations

##### Q1. Is this a random sample of DATA2002 students?
No, the data is not a random sample of students from DATA2002 because, whilst only a sample or subset of students completed the survey, means that only a 'type of student' is reflected in the sample, possibly high achieving or highly motivated students who had the time and made the active decision to complete the survey. As such, students who generally participate less in their courses are not reflected in the sample data and therefore the data is not a random sample. 


##### Q2. What are the potential biases in this data generation?
There could be some measurement biases in the data such as the same questions may be interpreted differently in the students responses. Furthermore, knowing that this survey was going to be used for an assessment, that there is some level of response bias, with students answering in a specific way or the way they think the researcher would like them to answer instead of their true response. 


##### Q3. Which variables are most likely to be subjected to this bias?
The more open ended questions are more likely to be subjected to bias. For example, the questions asking students the hours they spend on university work last semester could easily be subject to measurement bias with students differently interpreting what constitutes university work, as well as be subject to response bias with students over or under exaggerating the hours they work to appeal to the lecturer.


Data Analysis

### Q4. Is there any evidence to suggest that there’s a difference in the amount of exercise done by people who eat red meat compared to people who don’t eat red meat?

Cleaning data: Creating a separate varaible 'Meat' based off whether respondents eat meat to then compare the counts. Then cleaning the excercise variable by removing all values greater than 24 and converting the type of data to numeric.


```{r}
yes_answers = c("Well done","Rare","Medium","Medium-rare","Medium-well done")
x$Meat = ifelse(x$`How do you like your steak cooked?` %in% yes_answers, "Yes",
                ifelse(x$`How do you like your steak cooked?` == "I don't eat red meat", "No", NA))
x$`How many hours a week do you spend exercising?` <- as.numeric(as.character(x$`How many hours a week do you spend exercising?`))
x <- x %>% mutate(`How many hours a week do you spend exercising?` = ifelse(`How many hours a week do you spend exercising?` < 24, `How many hours a week do you spend exercising?`, NA))
```


####Performing a 2 sample T test. 
This will demonstrate whether the 2 samples: meat eaters and non meaters, if their level of exercise is independent or dependent. 

**1. Hypothesis:** $$H0: μ_x = μ_y H1: μ_x \text{  does not equal  } μ_y$$

**2. Assumptions:** $$X_i,..... X_n \text{  are independent and identically distributed, }$$
$$Y_i,..... Y_n \text{  are independent and identically distributed.}$$
$$X_i's \text{  independent of } Y_i's$$
```{r}

x %>% group_by(Meat) %>% summarize(Mean=mean(`How many hours a week do you spend exercising?`, na.rm=TRUE),SD=sd(`How many hours a week do you spend exercising?`, na.rm=TRUE), n=n())


```

**3. Test Statistic:** $$T = \frac{X-Y}{(S_p  \sqrt(1/n_1+1/n_2))}$$ where 
$$S^2_p= \frac{(n_x-1)S^2_x + (n_y-1)S^2_y}{n_x+n_y-2}   $$ Under $$ H_0, T ~ t_n_x+T_n_y$$

```{r}
nM=101
nV=7
sM=3.866192	
sV=4.690416	
mM=4.0125	
mV=5.0000	
sP = sqrt(((nM - 1) * sM^2 + (nV - 1) * sV^2)/
(nM + nV - 2))



t0 = (mM - mV)/(sP * sqrt(1/nM + 1/nV))
t0
```


**4. Observed Test Statistic:** $$t_0 = -0.645$$
```{r}
deg_free = nM+nV-2
p_val = 2 * (1 - pt(abs(t0), deg_free))
p_val
```

**5. P Value:** $$P(X^2_1 \geq -0.645) = 0.5203$$


**6. Decision:**
Since the P Value is greater than 0.05, we **retain the Null Hypothesis** and therefore there is no evidence that eating meat impacts the hours students excercise for.




### Q5 Is there any evidence that the weekly exercise time of students who participate in more than 3 univeristy clubs is different to those who don’t?

Creating a separate variable "TripleClub" for whether people are part of 3 or more clubs or not.
Comparing means of those part of 3 or more groups with those that aren't. Again, confidence intervals or something?

```{r}
x$TripleClub <- ifelse(x$`How many university clubs are you a member of?` >= 3, "Yes", "No")
x %>% group_by(TripleClub) %>% summarize(mean_size=mean(`How many hours a week do you spend exercising?`, na.rm=TRUE))

```

### Q6 Is there evidence that students who live with their parents study more hours per week than students who don’t live with their parents?

Cleaning the study variable (removed all values above 70, which is more than 10 hours a day - there was one with 60 but I figured probs shouldn't cut it?)
Then same deal, comparing the means.

```{r}
x <- x %>% mutate(`On average, how many hours per week did you spend on university work last semester?` =
                    ifelse(`On average, how many hours per week did you spend on university work last semester?` < 70,
                           `On average, how many hours per week did you spend on university work last semester?`, NA))
x %>% group_by(`Do you currently live with your parents?`) %>% summarize(mean_size=mean(`On average, how many hours per week did you spend on university work last semester?`, na.rm=TRUE))
```


# 4. Further Data Analysis

Our 3 additional questions.


### Shoe Size vs Height

Re-coding the gender column:

```{r}
x$Gender <- toupper(mapvalues(x$Gender %>% tolower,
                              from=c("female", "male", "man"),
                              to=c("f", "m", "m")))
x <- x %>% mutate(`Gender` = fct_lump(`Gender`, n = 2, other_level = NA))
x
```

Re-coding the shoe sizes (using https://www.finder.com.au/shoe-size-conversion-guide and only converting those clearly EU to what it says the equivalent AUS size is, likely slight discrepancies with the whole UK/US thing but nothing we can do about that)

```{r}
x <- x %>%
  mutate(`What is your shoe size?` = 
           case_when(`Gender` == "M" ~
                       recode_factor(as.character(`What is your shoe size?`),
                                     "35.5"="3", "37"="4","38"="5","39"="6","40"="6",
                                     "40.5"="7","41"="7.5","42"="8","42.5"="8.5","43"="9",
                                     "44"="9.5","44.5"="10","45"="10.5","46"="11",
                                     "47"="12","48"="13","49.5"="14"),
                    `Gender` == "F" ~
                        recode_factor(as.character(`What is your shoe size?`),
                                      "35"="4","36"="5","37"="6","38"="7","39"="8",
                                      "40"="9","41"="10","42"="11")))
x$`What is your shoe size?` <- as.numeric(as.character(x$`What is your shoe size?`))  # converting back to numeric
x <- x %>% mutate(`What is your shoe size?` = ifelse(`What is your shoe size?` < 16, `What is your shoe size?`, NA))  # removing values stupidly high
```


### Do more right handed people wear glasses?



####Performing  Fisher's Exact Test
This will demonstrate whether 'handedness' and needing glasses are independent or not.

**1. Hypothesis:** $$H_0: θ = 1 $$ $$H_1 θ > 1$$

**2. Assumptions:** As this is an 'exact' test we do not have to assume that the categories have to be greater than 5


```{r}


handed=recode(x$`What is your dominant hand?`, `Left handed` ="Left", `Right handed`="Right",.default = NA_character_)


tab=table(handed,x$`Do you wear glasses or contacts?`)
tab
```
**3. Test Statistic:** ??


```{r}

fisher.test(tab)
```
**4. Observed Test Statistic:** ??

**5. P Value:** 0.4901


**6. Decision:**
Since the P Value is greater than 0.05, we **retain the Null Hypothesis** and therefore the sample data supports the claim that handedness and needing glasses is independent




### Is there a difference between students who live at home and whether they had a pet growing up

**1. Hypothesis:** H0: $$p_ij =P_i\times P_j for i = 1,2 and j =1,2$$ H1: At least one equality does not hold.

**2. Assumptions:** $$e_ij = y_i\times y_j/n ≥ 5$$
```{r}


table(x$`Do you currently live with your parents?`,x$`Did you have a pet growing up?`)
```
**3. Test Statistic:** $$T = \sum_{i=1}^{2}\sum_{j=1}^{2} \frac{(y_i\times y_j/n)^2}{y_i\times y_j/n}. Under H_0   T ∼ χ_1^2$$


#### Chi Squared Test of Independence
```{r  warning=FALSE}
y=c(35,13,25,36)
n=sum(y)
c=2
r=2
y.mat = matrix(y, nrow = r, ncol = c)
chisq.test(y.mat)

```

**4. Observed Test Statistic:** $$t_0 = 9.87167$$

**5. P Value:** $$P(X^2_1 \geq 9.87167) = 0.001729$$


**6. Decision:**
Since the P Value is less than 0.05, we **reject the Null Hypothesis** and can state that having a pet whilst growing up means you are more likey to be living at home.


# BACKUP CODE

```{r}
## Sayano's Original Work for Q4 ##
x$`How do you like your steak cooked?`[x$`How do you like your steak cooked?`=="Well done"] = "eat red meat"
x$`How do you like your steak cooked?`[x$`How do you like your steak cooked?`=="Rare"] = "eat red meat"
x$`How do you like your steak cooked?`[x$`How do you like your steak cooked?`=="Medium"] = "eat red meat"
x$`How do you like your steak cooked?`[x$`How do you like your steak cooked?`=="Medium-rare"] = "eat red meat"
x$`How do you like your steak cooked?`[x$`How do you like your steak cooked?`=="Medium-well done"] = "eat red meat"
red_meat = x %>% dplyr::count(`How do you like your steak cooked?`,)
eat_red_meat=c(21,18,11,14,2,7,27)
no_red_meat=c(0,3,1,0,0,1,2)
(meat <- with(x, table(`How do you like your steak cooked?`, `How many hours a week do you spend exercising?`)))
c(mean(no_red_meat), mean(eat_red_meat))
```

```{r}
## Sayano's Original Work for Q5 ##
x$`How many hours a week do you spend exercising?`[x$`How many hours a week do you spend exercising?`=="0"] = "0-1"
x$`How many hours a week do you spend exercising?`[x$`How many hours a week do you spend exercising?`=="0.5"] = "0-1"
x$`How many hours a week do you spend exercising?`[x$`How many hours a week do you spend exercising?`=="1"] = "1-2"
x$`How many hours a week do you spend exercising?`[x$`How many hours a week do you spend exercising?`=="2"] = "1-2"
x$`How many hours a week do you spend exercising?`[x$`How many hours a week do you spend exercising?`=="2.5"] = "2-3"
x$`How many hours a week do you spend exercising?`[x$`How many hours a week do you spend exercising?`=="2.75"] = "2-3"
x$`How many hours a week do you spend exercising?`[x$`How many hours a week do you spend exercising?`=="3"] = "2-3"
x$`How many hours a week do you spend exercising?`[x$`How many hours a week do you spend exercising?`=="3.5"] = "3-4"
x$`How many hours a week do you spend exercising?`[x$`How many hours a week do you spend exercising?`=="3.75"] = "3-4"
x$`How many hours a week do you spend exercising?`[x$`How many hours a week do you spend exercising?`=="4"] = "4-5"
x$`How many hours a week do you spend exercising?`[x$`How many hours a week do you spend exercising?`=="5"] = "5-9"
x$`How many hours a week do you spend exercising?`[x$`How many hours a week do you spend exercising?`=="6"] = "5-9"
x$`How many hours a week do you spend exercising?`[x$`How many hours a week do you spend exercising?`=="7"] = "5-9"
x$`How many hours a week do you spend exercising?`[x$`How many hours a week do you spend exercising?`=="8"] = "5-9"
x$`How many hours a week do you spend exercising?`[x$`How many hours a week do you spend exercising?`=="10"] = "10+"
x$`How many hours a week do you spend exercising?`[x$`How many hours a week do you spend exercising?`=="12"] = "10+"
x$`How many hours a week do you spend exercising?`[x$`How many hours a week do you spend exercising?`=="14"] = "10+"
x$`How many hours a week do you spend exercising?`[x$`How many hours a week do you spend exercising?`=="20"] = "10+"
x$`How many hours a week do you spend exercising?`[x$`How many hours a week do you spend exercising?`=="420"] = "NA"
x$`How many hours a week do you spend exercising?`[x$`How many hours a week do you spend exercising?`=="09999900"] = "NA"
x$`How many hours a week do you spend exercising?`[x$`How many hours a week do you spend exercising?`=="9223372036854775808"] = "NA"
(gender_hand <- with(x, table(`How many hours a week do you spend exercising?`, `How many university clubs are you a member of?`)))
```

